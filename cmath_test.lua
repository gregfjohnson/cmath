-------------------- Test code for cmath --------------------
-- to run:  ./test.lua -a cmath_test.lua
-------------------------------------------------------------
package.path = './?.lua'
require 'cmath'

local i, e, pi = cmath.i, cmath.exp(1), cmath.pi

local re       = function(c) return cmath.re(c) end
local im       = function(c) return cmath.im(c) end

local cnew     = function(real,imag)
    real,imag = real or 0, imag or 0
    return real + imag * i
end

local function relError(a,b)
    local avg = (a+b) / 2
    return cmath.abs((a-b) / avg)
end

if TESTX then
    test:check(cnew(-1), e^(i*pi), "Euler's formula")
end

if TESTX then
    test:check('i', tostring(cnew(0,1)), 'tostring(i)')
    test:check('1', tostring(cnew(1,0)), 'tostring(1)')
    test:check('1 + i', tostring(cnew(1,1)), 'tostring(1 + i)')
    test:check('1 + i * 2', tostring(cnew(1,2)), 'tostring(1 + 2i)')

    test:check('-i', tostring(cnew(0,-1)), 'tostring(-i)')
    test:check('-1', tostring(cnew(-1,0)), 'tostring(-1)')
    test:check('-1 - i', tostring(cnew(-1,-1)), 'tostring(-1 - i)')
    test:check('-1 - i * 2', tostring(cnew(-1,-2)), 'tostring(-1 - 2i)')
end

if TESTX then
    local c = 1 + cmath.i
    test:check('1 + i', tostring(c), 'tostring')
    test:check(1, re(c), 'real')
    test:check(1, im(c), 'imag')
end

if TESTX then
    local c = 1 - cmath.i
    test:check('1 - i', tostring(c), 'tostring')
end

if TESTX then
    local c = cnew(1,1)
    test:check('complex', cmath.type(c), 'type error')
end

if TESTX then
    local c = cnew(0,1)
    test:check('There is no metatable.', getmetatable(c),  "getmetatable")
end

if TESTX then
    local c = cnew()
    local fn = function() setmetatable(c, {}) end
    local xx, oops = pcall(fn)
    test:check(false, xx, "can't setmetatable")
end

if TESTX then
    local c = cnew(0)
    local fn = function() c.foo = 10 end
    local xx, oops = pcall(fn)
    test:check(false, xx, "can't create new indices in c")
end

if TESTX then
    local c = cnew(2,3) + cnew(20, 30)
    test:check(cnew(22,33), c, 'add complexes')
    test:check(22, re(c), 'add complexes; real')
    test:check(33, im(c), 'add complexes; imag')
end

if TESTX then
    local c = cnew(2,3) + 20
    test:check(cnew(22,3) , c, 'add number on the right')
    test:check(22, re(c),   'add number on the right')
    test:check( 3, im(c),   'add number on the right')
end

if TESTX then
    local c = 30 + cnew(2,3)
    test:check(cnew(32, 3), c, 'add number on the left')
end

if TESTX then
    local c = cnew(0,1) * cnew(0, 1)
    test:check(cnew(-1, 0) , c, 'mult complexes')
end

if TESTX then
    local c = cnew(-1,0) / cnew(0, 1)
    test:check(cnew(0,1), c, 'mult complexes:  divide real part')
end

if TESTX then
    local omega8 = 2*pi*i/8
    local radius = .5
    for step = 0, 7 do
        test:check(radius, cmath.abs(radius * e ^ (omega8*step)), 'abs')
        radius = radius + .25
    end
end

if TESTX then
    test:check(cmath.pi/2, cmath.angle(cmath.i), 'angle')
end

if TESTX then
    test:check(cmath.i, cmath.sqrt(-1), 'sqrt(-1)')
    test:check(cnew(cmath.exp(2)), cmath.exp(cnew(2)), 'exp')
    test:check(cnew(cmath.sqrt(2)), cmath.sqrt(cnew(2)), 'sqrt(2)')
    test:check(cnew(2), cmath.log10(cnew(100)), 'log10')
    test:check(cnew(cmath.cos(.5)), cmath.cos(cnew(.5)), 'cos')
    test:check(cnew(cmath.sin(.5)), cmath.sin(cnew(.5)), 'sin')
    test:check(cnew(cmath.tan(.5)), cmath.tan(cnew(.5)), 'tan')
    test:check(cnew(cmath.acos(.5)), cmath.acos(cnew(.5)), 'acos')
    test:check(cnew(cmath.asin(.5)), cmath.asin(cnew(.5)), 'asin')
end

if TESTX then
    test:check(cnew(4),  cnew(2) ^ 2, 'exp 2^2')
    test:check(cnew(-4), cnew(0,2) * cnew(0,2), '2i * 2i')
    test:check(cnew(-4), cnew(0,2) ^ 2, 'exp 2i^2')

    test:check(cnew(-1), cmath.exp(1) ^ cnew(0,cmath.pi), 'exp')

    local omega8 = cnew(0,1) ^ .5
    test:check(cnew(cmath.sqrt(2)/2, cmath.sqrt(2)/2), omega8, 'omega8')

    for i = 0,8 do
        local actual = omega8 ^ i
        local angle = i * 2 * cmath.pi / 8
        local expected = cnew(cmath.cos(angle), cmath.sin(angle))
        test:check(expected, actual, '8th roots of unity')
    end
end

angleTest = {
    { 1.0000000000000000, 0.0000000000000000, 0.0000000000000000 },
    { 0.9980267284282716, 0.0627905195293134, 0.0628318530717959 },
    { 0.9921147013144779, 0.1253332335643043, 0.1256637061435917 },
    { 0.9822872507286887, 0.1873813145857246, 0.1884955592153876 },
    { 0.9685831611286311, 0.2486898871648548, 0.2513274122871835 },
    { 0.9510565162951535, 0.3090169943749474, 0.3141592653589793 },
    { 0.9297764858882513, 0.3681245526846780, 0.3769911184307752 },
    { 0.9048270524660195, 0.4257792915650727, 0.4398229715025711 },
    { 0.8763066800438636, 0.4817536741017153, 0.5026548245743669 },
    { 0.8443279255020151, 0.5358267949789967, 0.5654866776461628 },
    { 0.8090169943749475, 0.5877852522924731, 0.6283185307179586 },
    { 0.7705132427757891, 0.6374239897486897, 0.6911503837897546 },
    { 0.7289686274214116, 0.6845471059286887, 0.7539822368615504 },
    { 0.6845471059286886, 0.7289686274214116, 0.8168140899333463 },
    { 0.6374239897486896, 0.7705132427757893, 0.8796459430051422 },
    { 0.5877852522924730, 0.8090169943749475, 0.9424777960769380 },
    { 0.5358267949789965, 0.8443279255020151, 1.0053096491487339 },
    { 0.4817536741017152, 0.8763066800438637, 1.0681415022205298 },
    { 0.4257792915650727, 0.9048270524660196, 1.1309733552923256 },
    { 0.3681245526846779, 0.9297764858882515, 1.1938052083641215 },
    { 0.3090169943749475, 0.9510565162951535, 1.2566370614359172 },
    { 0.2486898871648547, 0.9685831611286311, 1.3194689145077132 },
    { 0.1873813145857245, 0.9822872507286887, 1.3823007675795091 },
    { 0.1253332335643043, 0.9921147013144779, 1.4451326206513049 },
    { 0.0627905195293133, 0.9980267284282716, 1.5079644737231008 },
    { -0.0000000000000002, 1.0000000000000000, 1.5707963267948968 },
    { -0.0627905195293134, 0.9980267284282716, 1.6336281798666925 },
    { -0.1253332335643044, 0.9921147013144778, 1.6964600329384885 },
    { -0.1873813145857248, 0.9822872507286886, 1.7592918860102844 },
    { -0.2486898871648549, 0.9685831611286311, 1.8221237390820801 },
    { -0.3090169943749476, 0.9510565162951535, 1.8849555921538761 },
    { -0.3681245526846780, 0.9297764858882513, 1.9477874452256718 },
    { -0.4257792915650727, 0.9048270524660195, 2.0106192982974678 },
    { -0.4817536741017154, 0.8763066800438635, 2.0734511513692637 },
    { -0.5358267949789969, 0.8443279255020150, 2.1362830044410597 },
    { -0.5877852522924730, 0.8090169943749475, 2.1991148575128552 },
    { -0.6374239897486897, 0.7705132427757893, 2.2619467105846511 },
    { -0.6845471059286887, 0.7289686274214114, 2.3247785636564471 },
    { -0.7289686274214117, 0.6845471059286885, 2.3876104167282430 },
    { -0.7705132427757894, 0.6374239897486895, 2.4504422698000390 },
    { -0.8090169943749473, 0.5877852522924732, 2.5132741228718345 },
    { -0.8443279255020151, 0.5358267949789967, 2.5761059759436304 },
    { -0.8763066800438636, 0.4817536741017152, 2.6389378290154264 },
    { -0.9048270524660196, 0.4257792915650725, 2.7017696820872223 },
    { -0.9297764858882515, 0.3681245526846778, 2.7646015351590183 },
    { -0.9510565162951536, 0.3090169943749471, 2.8274333882308142 },
    { -0.9685831611286311, 0.2486898871648548, 2.8902652413026098 },
    { -0.9822872507286887, 0.1873813145857246, 2.9530970943744057 },
    { -0.9921147013144779, 0.1253332335643041, 3.0159289474462017 },
    { -0.9980267284282716, 0.0627905195293131, 3.0787608005179976 },
    { -1.0000000000000000, -0.0000000000000003, 3.1415926535897936 },
    { -0.9980267284282716, -0.0627905195293133, 3.2044245066615891 },
    { -0.9921147013144779, -0.1253332335643043, 3.2672563597333850 },
    { -0.9822872507286886, -0.1873813145857248, 3.3300882128051810 },
    { -0.9685831611286311, -0.2486898871648550, 3.3929200658769769 },
    { -0.9510565162951535, -0.3090169943749477, 3.4557519189487729 },
    { -0.9297764858882512, -0.3681245526846783, 3.5185837720205688 },
    { -0.9048270524660195, -0.4257792915650727, 3.5814156250923643 },
    { -0.8763066800438635, -0.4817536741017154, 3.6442474781641603 },
    { -0.8443279255020150, -0.5358267949789968, 3.7070793312359562 },
    { -0.8090169943749472, -0.5877852522924734, 3.7699111843077522 },
    { -0.7705132427757890, -0.6374239897486900, 3.8327430373795481 },
    { -0.7289686274214116, -0.6845471059286887, 3.8955748904513436 },
    { -0.6845471059286886, -0.7289686274214116, 3.9584067435231396 },
    { -0.6374239897486895, -0.7705132427757894, 4.0212385965949355 },
    { -0.5877852522924732, -0.8090169943749473, 4.0840704496667311 },
    { -0.5358267949789963, -0.8443279255020153, 4.1469023027385274 },
    { -0.4817536741017153, -0.8763066800438636, 4.2097341558103230 },
    { -0.4257792915650722, -0.9048270524660198, 4.2725660088821193 },
    { -0.3681245526846778, -0.9297764858882515, 4.3353978619539149 },
    { -0.3090169943749476, -0.9510565162951535, 4.3982297150257104 },
    { -0.2486898871648544, -0.9685831611286312, 4.4610615680975068 },
    { -0.1873813145857246, -0.9822872507286887, 4.5238934211693023 },
    { -0.1253332335643037, -0.9921147013144779, 4.5867252742410987 },
    { -0.0627905195293132, -0.9980267284282716, 4.6495571273128942 },
    { -0.0000000000000002, -1.0000000000000000, 4.7123889803846897 },
    { 0.0627905195293137, -0.9980267284282716, 4.7752208334564861 },
    { 0.1253332335643042, -0.9921147013144779, 4.8380526865282816 },
    { 0.1873813145857251, -0.9822872507286886, 4.9008845396000780 },
    { 0.2486898871648549, -0.9685831611286311, 4.9637163926718735 },
    { 0.3090169943749472, -0.9510565162951536, 5.0265482457436690 },
    { 0.3681245526846783, -0.9297764858882512, 5.0893800988154654 },
    { 0.4257792915650726, -0.9048270524660196, 5.1522119518872609 },
    { 0.4817536741017157, -0.8763066800438634, 5.2150438049590573 },
    { 0.5358267949789968, -0.8443279255020150, 5.2778756580308528 },
    { 0.5877852522924737, -0.8090169943749470, 5.3407075111026492 },
    { 0.6374239897486900, -0.7705132427757890, 5.4035393641744447 },
    { 0.6845471059286886, -0.7289686274214116, 5.4663712172462402 },
    { 0.7289686274214119, -0.6845471059286883, 5.5292030703180366 },
    { 0.7705132427757894, -0.6374239897486896, 5.5920349233898321 },
    { 0.8090169943749478, -0.5877852522924726, 5.6548667764616285 },
    { 0.8443279255020153, -0.5358267949789963, 5.7176986295334240 },
    { 0.8763066800438636, -0.4817536741017153, 5.7805304826052195 },
    { 0.9048270524660197, -0.4257792915650722, 5.8433623356770159 },
    { 0.9297764858882515, -0.3681245526846779, 5.9061941887488114 },
    { 0.9510565162951538, -0.3090169943749468, 5.9690260418206078 },
    { 0.9685831611286312, -0.2486898871648545, 6.0318578948924033 },
    { 0.9822872507286887, -0.1873813145857247, 6.0946897479641988 },
    { 0.9921147013144779, -0.1253332335643038, 6.1575216010359952 },
    { 0.9980267284282716, -0.0627905195293133, 6.2203534541077907 },
}

if TESTX then
    for j = 1, #angleTest do
        local c = angleTest[j][1] + i * angleTest[j][2]
        test:checkNear(angleTest[j][3], cmath.angle(c), 'angle ' .. j)
    end
end

expTest = {
    { -5.000000000000, 0.000000000000, 0.006737946999, 0.000000000000 },
    { -4.900000000000, 0.062831853072, 0.007431888940, 0.000467574820 },
    { -4.800000000000, 0.125663706144, 0.008164853035, 0.001031460809 },
    { -4.700000000000, 0.188495559215, 0.008934174739, 0.001704284980 },
    { -4.600000000000, 0.251327412287, 0.009736038841, 0.002499789897 },
    { -4.500000000000, 0.314159265359, 0.010565283547, 0.003432868721 },
    { -4.400000000000, 0.376991118431, 0.011415181951, 0.004519590260 },
    { -4.300000000000, 0.439822971503, 0.012277199257, 0.005777211444 },
    { -4.200000000000, 0.502654824574, 0.013140724139, 0.007224174229 },
    { -4.100000000000, 0.565486677646, 0.013992772642, 0.008880083545 },
    { -4.000000000000, 0.628318530718, 0.014817663124, 0.010765662425 },
    { -3.900000000000, 0.691150383790, 0.015596660828, 0.012902679954 },
    { -3.800000000000, 0.753982236862, 0.016307590854, 0.015313847132 },
    { -3.700000000000, 0.816814089933, 0.016924418494, 0.018022675156 },
    { -3.600000000000, 0.879645943005, 0.017416796177, 0.021053289988 },
    { -3.500000000000, 0.942477796077, 0.017749576633, 0.024430196374 },
    { -3.400000000000, 1.005309649149, 0.017882292281, 0.028177983793 },
    { -3.300000000000, 1.068141502221, 0.017768601408, 0.032320965975 },
    { -3.200000000000, 1.130973355292, 0.017355702333, 0.036882744878 },
    { -3.100000000000, 1.193805208364, 0.016583717480, 0.041885689094 },
    { -3.000000000000, 1.256637061436, 0.015385050226, 0.047350315798 },
    { -2.900000000000, 1.319468914508, 0.013683718387, 0.053294564418 },
    { -2.800000000000, 1.382300767580, 0.011394669475, 0.059732949233 },
    { -2.700000000000, 1.445132620651, 0.008423084225, 0.066675577198 },
    { -2.600000000000, 1.507964473723, 0.004663676563, 0.074127016274 },
    { -2.500000000000, 1.570796326795, -0.000000000000, 0.082084998624 },
    { -2.400000000000, 1.633628179867, -0.005696227418, 0.090538942131 },
    { -2.300000000000, 1.696460032938, -0.012565765077, 0.099468272794 },
    { -2.200000000000, 1.759291886010, -0.020762441474, 0.108840529800 },
    { -2.100000000000, 1.822123739082, -0.030453675325, 0.118609234378 },
    { -2.000000000000, 1.884955592154, -0.041820902459, 0.128711503007 },
    { -1.900000000000, 1.947787445226, -0.055059881047, 0.139065385180 },
    { -1.800000000000, 2.010619298297, -0.070380843523, 0.149566905805 },
    { -1.700000000000, 2.073451151369, -0.088008458910, 0.160086792461 },
    { -1.600000000000, 2.136283004441, -0.108181564154, 0.170466868205 },
    { -1.500000000000, 2.199114857513, -0.131152617477, 0.180516091518 },
    { -1.400000000000, 2.261946710585, -0.157186820616, 0.190006226345 },
    { -1.300000000000, 2.324778563656, -0.186560850195, 0.198667127097 },
    { -1.200000000000, 2.387610416728, -0.219561131245, 0.206181626087 },
    { -1.100000000000, 2.450442269800, -0.256481578126, 0.212180014243 },
    { -1.000000000000, 2.513274122872, -0.297620719789, 0.216234110142 },
    { -0.900000000000, 2.576105975944, -0.343278117381, 0.217850917715 },
    { -0.800000000000, 2.638937829015, -0.393749972793, 0.216465879344 },
    { -0.700000000000, 2.701769682087, -0.449323816728, 0.211435738850 },
    { -0.600000000000, 2.764601535159, -0.510272154422, 0.202031038045 },
    { -0.500000000000, 2.827433388231, -0.576844936252, 0.187428281461 },
    { -0.400000000000, 2.890265241303, -0.649260709157, 0.166701816613 },
    { -0.300000000000, 2.953097094374, -0.727696293283, 0.138815492060 },
    { -0.200000000000, 3.015928947446, -0.812274816547, 0.102614172702 },
    { -0.100000000000, 3.078760800518, -0.903051928082, 0.056815211568 },
    { -0.000000000000, 3.141592653590, -1.000000000000, -0.000000000000 },
    { 0.100000000000, 3.204424506662, -1.102990115721, -0.069394256115 },
    { 0.200000000000, 3.267256359733, -1.211771632597, -0.153082357165 },
    { 0.300000000000, 3.330088212805, -1.325949096966, -0.252938317869 },
    { 0.400000000000, 3.392920065877, -1.444956281491, -0.371001715726 },
    { 0.500000000000, 3.455751918949, -1.568027108054, -0.509482891634 },
    { 0.600000000000, 3.518583772021, -1.694163215098, -0.670766668332 },
    { 0.700000000000, 3.581415625092, -1.822097926696, -0.857414201174 },
    { 0.800000000000, 3.644247478164, -1.950256382349, -1.072162519165 },
    { 0.900000000000, 3.707079331236, -2.076711592401, -1.317921251972 },
    { 1.000000000000, 3.769911184308, -2.199136194724, -1.597765970343 },
    { 1.100000000000, 3.832743037380, -2.314749704948, -1.914927492851 },
    { 1.200000000000, 3.895574890451, -2.420261076046, -2.272776430804 },
    { 1.300000000000, 3.958406743523, -2.511806414613, -2.674802155396 },
    { 1.400000000000, 4.021238596595, -2.584881742095, -3.124585276558 },
    { 1.500000000000, 4.084070449667, -2.634270740905, -3.625762621408 },
    { 1.600000000000, 4.146902302739, -2.653967489391, -4.181983591834 },
    { 1.700000000000, 4.209734155810, -2.637094267804, -4.796856665579 },
    { 1.800000000000, 4.272566008882, -2.575814611616, -5.473884683683 },
    { 1.900000000000, 4.335397861954, -2.461241900861, -6.216387439562 },
    { 2.000000000000, 4.398229715026, -2.283343906959, -7.027409952158 },
    { 2.100000000000, 4.461061568098, -2.030843874125, -7.909614668228 },
    { 2.200000000000, 4.523893421169, -1.691118893678, -8.865155698148 },
    { 2.300000000000, 4.586725274241, -1.250096539222, -9.895533047015 },
    { 2.400000000000, 4.649557127313, -0.692150971804, -11.001424660060 },
    { 2.500000000000, 4.712388980385, -0.000000000000, -12.182493960703 },
    { 2.600000000000, 4.775220833456, 0.845395106024, -13.437170423488 },
    { 2.700000000000, 4.838052686528, 1.864924891648, -14.762400595862 },
    { 2.800000000000, 4.900884539600, 3.081419529866, -16.153366865985 },
    { 2.900000000000, 4.963716392672, 4.519726161244, -17.603171172746 },
    { 3.000000000000, 5.026548245744, 6.206772250410, -19.102480774085 },
    { 3.100000000000, 5.089380098815, 8.171610885997, -20.639133136377 },
    { 3.200000000000, 5.152211951887, 10.445443327624, -22.197696987784 },
    { 3.300000000000, 5.215043804959, 13.061613414620, -23.758986599790 },
    { 3.400000000000, 5.277875658031, 16.055567692827, -25.299526432554 },
    { 3.500000000000, 5.340707511103, 19.464774284319, -26.790963410989 },
    { 3.600000000000, 5.403539364174, 23.328592616847, -28.199424301067 },
    { 3.700000000000, 5.466371217246, 27.688085142301, -29.484815942254 },
    { 3.800000000000, 5.529203070318, 32.585761104193, -30.600066476473 },
    { 3.900000000000, 5.592034923390, 38.065241261368, -31.490306212204 },
    { 4.000000000000, 5.654866776462, 44.170831238247, -32.091987391934 },
    { 4.100000000000, 5.717698629533, 50.946989851276, -32.331942911405 },
    { 4.200000000000, 5.780530482605, 58.437677358779, -32.126384991329 },
    { 4.300000000000, 5.843362335677, 66.685567100559, -31.379845949906 },
    { 4.400000000000, 5.906194188749, 75.731102439860, -29.984064593070 },
    { 4.500000000000, 5.969026041821, 85.611379301558, -27.816823356742 },
    { 4.600000000000, 6.031857894892, 96.358832927183, -24.740743231665 },
    { 4.700000000000, 6.094689747964, 107.999705753389, -20.602045709062 },
    { 4.800000000000, 6.157521601036, 120.552271583197, -15.229293539372 },
    { 4.900000000000, 6.220353454108, 134.024789480309, -8.432125033894 },
}

if TESTX then
    local origEps = test.eps
    test.eps = 1e-10
    for j = 1, #expTest do
        local c = expTest[j][1] + i * expTest[j][2]

        local expected = expTest[j][3] + i * expTest[j][4]
        local actual = cmath.exp(c)

        test:checkNear(0, relError(expected, actual),
                   'exp ' .. j .. ' ' .. cmath.abs(expected-actual))
    end
    test.eps = origEps
end

sqrtTest = {
    { -5.000000000000, 0.000000000000, 0.000000000000, 2.236067977500 },
    { -4.900000000000, 0.062831853072, 0.014191977277, 2.213639856033 },
    { -4.800000000000, 0.125663706144, 0.028676229776, 2.191077891394 },
    { -4.700000000000, 0.188495559215, 0.043464524583, 2.168383998488 },
    { -4.600000000000, 0.251327412287, 0.058569170841, 2.145560613866 },
    { -4.500000000000, 0.314159265359, 0.074003032237, 2.122610762429 },
    { -4.400000000000, 0.376991118431, 0.089779535984, 2.099538131371 },
    { -4.300000000000, 0.439822971503, 0.105912677247, 2.076347151900 },
    { -4.200000000000, 0.502654824574, 0.122417017746, 2.053043089230 },
    { -4.100000000000, 0.565486677646, 0.139307677029, 2.029632141271 },
    { -4.000000000000, 0.628318530718, 0.156600314641, 2.006121546304 },
    { -3.900000000000, 0.691150383790, 0.174311101138, 1.982519699771 },
    { -3.800000000000, 0.753982236862, 0.192456675565, 1.958836280032 },
    { -3.700000000000, 0.816814089933, 0.211054086707, 1.935082382617 },
    { -3.600000000000, 0.879645943005, 0.230120715104, 1.911270662026 },
    { -3.500000000000, 0.942477796077, 0.249674172511, 1.887415479543 },
    { -3.400000000000, 1.005309649149, 0.269732175277, 1.863533054813 },
    { -3.300000000000, 1.068141502221, 0.290312387962, 1.839641617980 },
    { -3.200000000000, 1.130973355292, 0.311432233547, 1.815761558160 },
    { -3.100000000000, 1.193805208364, 0.333108666837, 1.791915562721 },
    { -3.000000000000, 1.256637061436, 0.355357908239, 1.768128740490 },
    { -2.900000000000, 1.319468914508, 0.378195136035, 1.744428720504 },
    { -2.800000000000, 1.382300767580, 0.401634136742, 1.720845716442 },
    { -2.700000000000, 1.445132620651, 0.425686915195, 1.697412545543 },
    { -2.600000000000, 1.507964473723, 0.450363268617, 1.674164589794 },
    { -2.500000000000, 1.570796326795, 0.475670332270, 1.651139686702 },
    { -2.400000000000, 1.633628179867, 0.501612108085, 1.628377937390 },
    { -2.300000000000, 1.696460032938, 0.528188991855, 1.605921421215 },
    { -2.200000000000, 1.759291886010, 0.555397318790, 1.583813809044 },
    { -2.100000000000, 1.822123739082, 0.583228950994, 1.562099871736 },
    { -2.000000000000, 1.884955592154, 0.611670933155, 1.540824886373 },
    { -1.900000000000, 1.947787445226, 0.640705243819, 1.520033950100 },
    { -1.800000000000, 2.010619298297, 0.670308668445, 1.499771219551 },
    { -1.700000000000, 2.073451151369, 0.700452816530, 1.480079102003 },
    { -1.600000000000, 2.136283004441, 0.731104298415, 1.460997431606 },
    { -1.500000000000, 2.199114857513, 0.762225068111, 1.442562669161 },
    { -1.400000000000, 2.261946710585, 0.793772927485, 1.424807166043 },
    { -1.300000000000, 2.324778563656, 0.825702175449, 1.407758531333 },
    { -1.200000000000, 2.387610416728, 0.857964374909, 1.391439135792 },
    { -1.100000000000, 2.450442269800, 0.890509201461, 1.375865777569 },
    { -1.000000000000, 2.513274122872, 0.923285332326, 1.361049523305 },
    { -0.900000000000, 2.576105975944, 0.956241332514, 1.346995726054 },
    { -0.800000000000, 2.638937829015, 0.989326497568, 1.333704209632 },
    { -0.700000000000, 2.701769682087, 1.022491618133, 1.321169598936 },
    { -0.600000000000, 2.764601535159, 1.055689639833, 1.309381768489 },
    { -0.500000000000, 2.827433388231, 1.088876201504, 1.298326377381 },
    { -0.400000000000, 2.890265241303, 1.122010044337, 1.287985457835 },
    { -0.300000000000, 2.953097094374, 1.155053293111, 1.278338026473 },
    { -0.200000000000, 3.015928947446, 1.187971617661, 1.269360691202 },
    { -0.100000000000, 3.078760800518, 1.220734287722, 1.261028231730 },
    { -0.000000000000, 3.141592653590, 1.253314137316, 1.253314137316 },
    { 0.100000000000, 3.204424506662, 1.285687456098, 1.246191090791 },
    { 0.200000000000, 3.267256359733, 1.317833824903, 1.239631392818 },
    { 0.300000000000, 3.330088212805, 1.349735911493, 1.233607324384 },
    { 0.400000000000, 3.392920065877, 1.381379240654, 1.228091448757 },
    { 0.500000000000, 3.455751918949, 1.412751950578, 1.223056856349 },
    { 0.600000000000, 3.518583772021, 1.443844545185, 1.218477357467 },
    { 0.700000000000, 3.581415625092, 1.474649649881, 1.214327628729 },
    { 0.800000000000, 3.644247478164, 1.505161776277, 1.210583319216 },
    { 0.900000000000, 3.707079331236, 1.535377099721, 1.207221122391 },
    { 1.000000000000, 3.769911184308, 1.565293252115, 1.204218819449 },
    { 1.100000000000, 3.832743037380, 1.594909131357, 1.201555299304 },
    { 1.200000000000, 3.895574890451, 1.624224727914, 1.199210559814 },
    { 1.300000000000, 3.958406743523, 1.653240968397, 1.197165694291 },
    { 1.400000000000, 4.021238596595, 1.681959575539, 1.195402866714 },
    { 1.500000000000, 4.084070449667, 1.710382943712, 1.193905278546 },
    { 1.600000000000, 4.146902302739, 1.738514028891, 1.192657129544 },
    { 1.700000000000, 4.209734155810, 1.766356251917, 1.191643574517 },
    { 1.800000000000, 4.272566008882, 1.793913413841, 1.190850677607 },
    { 1.900000000000, 4.335397861954, 1.821189622173, 1.190265365333 },
    { 2.000000000000, 4.398229715026, 1.848189226902, 1.189875379373 },
    { 2.100000000000, 4.461061568098, 1.874916765195, 1.189669229832 },
    { 2.200000000000, 4.523893421169, 1.901376913799, 1.189636149555 },
    { 2.300000000000, 4.586725274241, 1.927574448226, 1.189766049883 },
    { 2.400000000000, 4.649557127313, 1.953514207893, 1.190049478147 },
    { 2.500000000000, 4.712388980385, 1.979201066479, 1.190477577088 },
    { 2.600000000000, 4.775220833456, 2.004639906830, 1.191042046301 },
    { 2.700000000000, 4.838052686528, 2.029835599829, 1.191735105773 },
    { 2.800000000000, 4.900884539600, 2.054792986691, 1.192549461513 },
    { 2.900000000000, 4.963716392672, 2.079516864253, 1.193478273247 },
    { 3.000000000000, 5.026548245744, 2.104011972818, 1.194515124125 },
    { 3.100000000000, 5.089380098815, 2.128282986235, 1.195653992381 },
    { 3.200000000000, 5.152211951887, 2.152334503870, 1.196889224845 },
    { 3.300000000000, 5.215043804959, 2.176171044234, 1.198215512236 },
    { 3.400000000000, 5.277875658031, 2.199797040001, 1.199627866130 },
    { 3.500000000000, 5.340707511103, 2.223216834232, 1.201121597513 },
    { 3.600000000000, 5.403539364174, 2.246434677624, 1.202692296820 },
    { 3.700000000000, 5.466371217246, 2.269454726620, 1.204335815367 },
    { 3.800000000000, 5.529203070318, 2.292281042265, 1.206048248092 },
    { 3.900000000000, 5.592034923390, 2.314917589676, 1.207825917503 },
    { 4.000000000000, 5.654866776462, 2.337368238039, 1.209665358764 },
    { 4.100000000000, 5.717698629533, 2.359636761038, 1.211563305833 },
    { 4.200000000000, 5.780530482605, 2.381726837650, 1.213516678577 },
    { 4.300000000000, 5.843362335677, 2.403642053244, 1.215522570799 },
    { 4.400000000000, 5.906194188749, 2.425385900911, 1.217578239102 },
    { 4.500000000000, 5.969026041821, 2.446961783009, 1.219681092543 },
    { 4.600000000000, 6.031857894892, 2.468373012856, 1.221828682998 },
    { 4.700000000000, 6.094689747964, 2.489622816550, 1.224018696216 },
    { 4.800000000000, 6.157521601036, 2.510714334881, 1.226248943476 },
    { 4.900000000000, 6.220353454108, 2.531650625319, 1.228517353836 },
}

if TESTX then
    for j = 1, #sqrtTest do
        local c = sqrtTest[j][1] + i * sqrtTest[j][2]

        local expected = sqrtTest[j][3] + i * sqrtTest[j][4]
        local actual = cmath.sqrt(c)

        test:checkNear(0, cmath.abs(expected-actual),
                   'sqrt ' .. j .. ' ' .. cmath.abs(expected-actual))
    end
end

logTest = {
    { -5.000000000000, 0.000000000000, 1.609437912434, 3.141592653590, 0.698970004336, 1.364376353842 },
    { -4.900000000000, 0.062831853072, 1.589317410807, 3.128770529160, 0.690231781506, 1.358807775956 },
    { -4.800000000000, 0.125663706144, 1.568958495125, 3.115418693500, 0.681390016768, 1.353009147405 },
    { -4.700000000000, 0.188495559215, 1.548366085718, 3.101508697211, 0.672446846993, 1.346968112774 },
    { -4.600000000000, 0.251327412287, 1.527546647933, 3.087010528129, 0.663405080047, 1.340671637944 },
    { -4.500000000000, 0.314159265359, 1.506508416687, 3.071892573290, 0.654268292308, 1.334105993580 },
    { -4.400000000000, 0.376991118431, 1.485261647859, 3.056121594564, 0.645040937848, 1.327256744544 },
    { -4.300000000000, 0.439822971503, 1.463818898648, 3.039662722371, 0.635728470189, 1.320108747173 },
    { -4.200000000000, 0.502654824574, 1.442195338773, 3.022479472828, 0.626337477456, 1.312646156715 },
    { -4.100000000000, 0.565486677646, 1.420409094029, 3.004533794681, 0.616875831582, 1.304852447722 },
    { -4.000000000000, 0.628318530718, 1.398481623100, 2.985786153620, 0.607352851955, 1.296710450660 },
    { -3.900000000000, 0.691150383790, 1.376438127629, 2.966195662796, 0.597779483511, 1.288202408598 },
    { -3.800000000000, 0.753982236862, 1.354307994291, 2.945720269779, 0.588168488718, 1.279310058396 },
    { -3.700000000000, 0.816814089933, 1.332125265850, 2.924317011579, 0.578534652162, 1.270014741465 },
    { -3.600000000000, 0.879645943005, 1.309929135951, 2.901942350673, 0.568894995428, 1.260297549699 },
    { -3.500000000000, 0.942477796077, 1.287764459400, 2.878552606147, 0.559268998708, 1.250139512718 },
    { -3.400000000000, 1.005309649149, 1.265682266034, 2.854104494817, 0.549678823982, 1.239521832874 },
    { -3.300000000000, 1.068141502221, 1.243740261797, 2.828555797347, 0.540149532620, 1.228426174543 },
    { -3.200000000000, 1.130973355292, 1.222003295311, 2.801866163614, 0.530709288021, 1.216835013889 },
    { -3.100000000000, 1.193805208364, 1.200543762228, 2.773998069450, 0.521389531219, 1.204732054372 },
    { -3.000000000000, 1.256637061436, 1.179441913071, 2.744917933058, 0.512225114572, 1.192102711604 },
    { -2.900000000000, 1.319468914508, 1.158786023545, 2.714597393306, 0.503254375732, 1.178934668502 },
    { -2.800000000000, 1.382300767580, 1.138672380084, 2.683014743353, 0.494519131366, 1.165218497903 },
    { -2.700000000000, 1.445132620651, 1.119205028428, 2.650156501276, 0.486064567965, 1.150948344684 },
    { -2.600000000000, 1.507964473723, 1.100495230632, 2.616019084547, 0.477939006024, 1.136122652972 },
    { -2.500000000000, 1.570796326795, 1.082660577269, 2.580610537481, 0.470193514482, 1.120744916369 },
    { -2.400000000000, 1.633628179867, 1.065823708429, 2.543952241195, 0.462881355252, 1.104824420576 },
    { -2.300000000000, 1.696460032938, 1.050110610664, 2.506080515539, 0.456057243599, 1.088376939104 },
    { -2.200000000000, 1.759291886010, 1.035648478467, 2.467048004376, 0.449776419390, 1.071425334891 },
    { -2.100000000000, 1.822123739082, 1.022563158295, 2.426924722452, 0.444093537045, 1.054000014956 },
    { -2.000000000000, 1.884955592154, 1.010976229672, 2.385798637430, 0.439061397882, 1.036139183168 },
    { -1.900000000000, 1.947787445226, 1.001001818826, 2.343775667902, 0.434729566291, 1.017888839389 },
    { -1.800000000000, 2.010619298297, 0.992743281522, 2.300978999895, 0.431142929112, 0.999302482630 },
    { -1.700000000000, 2.073451151369, 0.986289927492, 2.257547661525, 0.428340273066, 0.980440492034 },
    { -1.600000000000, 2.136283004441, 0.981713982893, 2.213634346455, 0.426352965578, 0.961369181617 },
    { -1.500000000000, 2.199114857513, 0.979067993748, 2.169402537407, 0.425203827093, 0.942159551023 },
    { -1.400000000000, 2.261946710585, 0.978382858333, 2.125023044208, 0.424906276563, 0.922885782017 },
    { -1.300000000000, 2.324778563656, 0.979666639344, 2.080670128080, 0.425463815572, 0.903623555286 },
    { -1.200000000000, 2.387610416728, 0.982904250175, 2.036517426611, 0.426869892090, 0.884448280677 },
    { -1.100000000000, 2.450442269800, 0.988058040670, 1.992733914936, 0.429108154863, 0.865433343158 },
    { -1.000000000000, 2.513274122872, 0.995069235157, 1.949480134851, 0.432153077940, 0.846648465146 },
    { -0.900000000000, 2.576105975944, 1.003860109558, 1.906904895266, 0.435970906184, 0.828158273528 },
    { -0.800000000000, 2.638937829015, 1.014336743179, 1.865142599490, 0.440520850354, 0.810021138921 },
    { -0.700000000000, 2.701769682087, 1.026392150261, 1.824311294770, 0.445756447127, 0.792288328592 },
    { -0.600000000000, 2.764601535159, 1.039909588196, 1.784511476286, 0.451626995832, 0.775003487044 },
    { -0.500000000000, 2.827433388231, 1.054765851659, 1.745825619442, 0.458078989075, 0.758202432889 },
    { -0.400000000000, 2.890265241303, 1.070834390197, 1.708318367228, 0.465057466695, 0.741913240221 },
    { -0.300000000000, 2.953097094374, 1.087988124858, 1.672037266928, 0.472507239002, 0.726156558564 },
    { -0.200000000000, 3.015928947446, 1.106101881099, 1.637013933343, 0.480373943384, 0.710946118050 },
    { -0.100000000000, 3.078760800518, 1.125054395185, 1.603265512421, 0.488604915670, 0.696289365070 },
    { -0.000000000000, 3.141592653590, 1.144729885849, 1.570796326795, 0.497149872694, 0.682188176921 },
    { 0.100000000000, 3.204424506662, 1.165019209988, 1.539599599740, 0.505961414209, 0.668639610508 },
    { 0.200000000000, 3.267256359733, 1.185820640182, 1.509659173032, 0.514995360558, 0.655636648402 },
    { 0.300000000000, 3.330088212805, 1.207040313171, 1.480951154341, 0.524210947445, 0.643168914298 },
    { 0.400000000000, 3.392920065877, 1.228592403428, 1.453445448937, 0.533570901317, 0.631223338221 },
    { 0.500000000000, 3.455751918949, 1.250399076051, 1.427107147380, 0.543041418906, 0.619784759192 },
    { 0.600000000000, 3.518583772021, 1.272390269868, 1.401897754786, 0.552592073031, 0.608836459096 },
    { 0.700000000000, 3.581415625092, 1.294503356191, 1.377776258088, 0.562195664399, 0.598360626185 },
    { 0.800000000000, 3.644247478164, 1.316682712210, 1.354700035619, 0.571828036330, 0.588338750104 },
    { 0.900000000000, 3.707079331236, 1.338879241276, 1.332625618690, 0.581467866421, 0.578751952640 },
    { 1.000000000000, 3.769911184308, 1.361049865892, 1.311509318098, 0.591096446352, 0.569581259815 },
    { 1.100000000000, 3.832743037380, 1.383157013430, 1.291307730186, 0.600697458538, 0.560807821659 },
    { 1.200000000000, 3.895574890451, 1.405168109479, 1.271978137491, 0.610256756093, 0.552413086214 },
    { 1.300000000000, 3.958406743523, 1.427055089565, 1.253478818670, 0.619762150770, 0.544378934131 },
    { 1.400000000000, 4.021238596595, 1.448793936464, 1.235769281500, 0.629203212021, 0.536687779861 },
    { 1.500000000000, 4.084070449667, 1.470364247646, 1.218810431491, 0.638571079141, 0.529322644883 },
    { 1.600000000000, 4.146902302739, 1.491748835257, 1.202564687330, 0.647858287538, 0.522267207839 },
    { 1.700000000000, 4.209734155810, 1.512933359473, 1.186996052936, 0.657058609506, 0.515505835831 },
    { 1.800000000000, 4.272566008882, 1.533905994921, 1.172070154591, 0.666166909352, 0.509023600542 },
    { 1.900000000000, 4.335397861954, 1.554657129046, 1.157754250325, 0.675179012396, 0.502806282316 },
    { 2.000000000000, 4.398229715026, 1.575179090781, 1.144017217619, 0.684091587136, 0.496840364814 },
    { 2.100000000000, 4.461061568098, 1.595465907549, 1.130829524443, 0.692902039713, 0.491113022439 },
    { 2.200000000000, 4.523893421169, 1.615513088456, 1.118163187812, 0.701608419759, 0.485612102334 },
    { 2.300000000000, 4.586725274241, 1.635317431476, 1.105991723237, 0.710209336650, 0.480326102433 },
    { 2.400000000000, 4.649557127313, 1.654876852449, 1.094290087842, 0.718703885248, 0.475244146751 },
    { 2.500000000000, 4.712388980385, 1.674190233796, 1.083034619336, 0.727091580194, 0.470355958888 },
    { 2.600000000000, 4.775220833456, 1.693257290967, 1.072202972615, 0.735372297909, 0.465651834487 },
    { 2.700000000000, 4.838052686528, 1.712078454756, 1.061774055358, 0.743546225486, 0.461122613270 },
    { 2.800000000000, 4.900884539600, 1.730654767789, 1.051727963691, 0.751613815730, 0.456759651094 },
    { 2.900000000000, 4.963716392672, 1.748987793617, 1.042045918741, 0.759575747684, 0.452554792399 },
    { 3.000000000000, 5.026548245744, 1.767079536993, 1.032710204677, 0.767432892000, 0.448500343297 },
    { 3.100000000000, 5.089380098815, 1.784932374056, 1.023704108698, 0.775186280623, 0.444589045509 },
    { 3.200000000000, 5.152211951887, 1.802548991277, 1.015011863261, 0.782837080272, 0.440814051281 },
    { 3.300000000000, 5.215043804959, 1.819932332134, 1.006618590782, 0.790386569283, 0.437168899358 },
    { 3.400000000000, 5.277875658031, 1.837085550606, 0.998510250903, 0.797836117412, 0.433647492091 },
    { 3.500000000000, 5.340707511103, 1.854011970667, 0.990673590410, 0.805187168243, 0.430244073682 },
    { 3.600000000000, 5.403539364174, 1.870715051065, 0.983096095791, 0.812441223891, 0.426953209583 },
    { 3.700000000000, 5.466371217246, 1.887198354742, 0.975765948417, 0.819599831722, 0.423769767027 },
    { 3.800000000000, 5.529203070318, 1.903465522329, 0.968671982285, 0.826664572841, 0.420688896681 },
    { 3.900000000000, 5.592034923390, 1.919520249221, 0.961803644236, 0.833637052138, 0.417706015366 },
    { 4.000000000000, 5.654866776462, 1.935366265798, 0.955150956571, 0.840518889698, 0.414816789823 },
    { 4.100000000000, 5.717698629533, 1.951007320389, 0.948704481945, 0.847311713398, 0.412017121466 },
    { 4.200000000000, 5.780530482605, 1.966447164657, 0.942455290444, 0.854017152565, 0.409303132080 },
    { 4.300000000000, 5.843362335677, 1.981689541090, 0.936394928728, 0.860636832541, 0.406671150429 },
    { 4.400000000000, 5.906194188749, 1.996738172341, 0.930515391125, 0.867172370053, 0.404117699691 },
    { 4.500000000000, 5.969026041821, 2.011596752191, 0.924809092570, 0.873625369291, 0.401639485717 },
    { 4.600000000000, 6.031857894892, 2.026268937916, 0.919268843283, 0.879997418589, 0.399233386023 },
    { 4.700000000000, 6.094689747964, 2.040758343898, 0.913887825066, 0.886290087653, 0.396896439505 },
    { 4.800000000000, 6.157521601036, 2.055068536300, 0.908659569140, 0.892504925248, 0.394625836806 },
    { 4.900000000000, 6.220353454108, 2.069203028697, 0.903577935408, 0.898643457301, 0.392418911317 },
}

if TESTX then
    for j = 1, #logTest do
        local c = logTest[j][1] + i * logTest[j][2]

        local expected2  = logTest[j][3] + i * logTest[j][4]
        local actual2    = cmath.log(c)

        local expected10 = logTest[j][5] + i * logTest[j][6]
        local actual10   = cmath.log10(c)

        test:checkNear(0, relError(expected2, actual2),
                      'log ' .. j .. ' ' .. relError(expected2, actual2))

        test:checkNear(0, relError(expected10, actual10),
                      'log10 ' .. j .. ' ' .. relError(expected10, actual10))
    end
end

trigTest = {
    { -5.000000000000, 0.000000000000, 0.958924274663, 0.000000000000, 0.283662185463, -0.000000000000, 3.380515006247, 0.000000000000 },
    { -4.900000000000, 0.062831853072, 0.984392534433, 0.011726630053, 0.186880651219, -0.061769942488, 4.729995369678, 1.626161777709 },
    { -4.800000000000, 0.125663706144, 1.004040365224, 0.011024408256, 0.088190757341, -0.125511462034, 3.704235503482, 5.396806154821 },
    { -4.700000000000, 0.188495559215, 1.017739841340, -0.002349061183, -0.012609404064, -0.189599218439, -0.343084734737, 5.345031248724 },
    { -4.600000000000, 0.251327412287, 1.025240026588, -0.028484683864, -0.115713294451, -0.252379280878, -1.445743633525, 3.399440179223 },
    { -4.500000000000, 0.314159265359, 1.026167354319, -0.067318173925, -0.221283993091, -0.312176725796, -1.407307449299, 2.289577291869 },
    { -4.400000000000, 0.376991118431, 1.020028699108, -0.118625754120, -0.329432181958, -0.367303743478, -1.201369851917, 1.699571045862 },
    { -4.300000000000, 0.439822971503, 1.006217175438, -0.182019321866, -0.440194286506, -0.416068480526, -1.000857378860, 1.359500904615 },
    { -4.200000000000, 0.502654824574, 0.984020688922, -0.256941183368, -0.553511015836, -0.456784839030, -0.829664448500, 1.148882870857 },
    { -4.100000000000, 0.565486677646, 0.952633254313, -0.342658495090, -0.669206555381, -0.487783442452, -0.685893534874, 1.011983518751 },
    { -4.000000000000, 0.628318530718, 0.911169081492, -0.438257588345, -0.786968675894, -0.507423962937, -0.564187744572, 0.920671929812 },
    { -3.900000000000, 0.691150383790, 0.858679415274, -0.542638388259, -0.906330034090, -0.514108985038, -0.459843673992, 0.859563429952 },
    { -3.800000000000, 0.753982236862, 0.794172097005, -0.654509172321, -1.026650952342, -0.506299556539, -0.369335911754, 0.819659085434 },
    { -3.700000000000, 0.816814089933, 0.716633795173, -0.772381945888, -1.147103977031, -0.482532548302, -0.290151962169, 0.795385361621 },
    { -3.600000000000, 0.879645943005, 0.625054828317, -0.894568741734, -1.266660527116, -0.441439911730, -0.220549299127, 0.783104852198 },
    { -3.500000000000, 0.942477796077, 0.518456476195, -1.019179177716, -1.384079955588, -0.381769884721, -0.159352491016, 0.780312694711 },
    { -3.400000000000, 1.005309649149, 0.395920644319, -1.144119630202, -1.497901356361, -0.302410154877, -0.105798590194, 0.785174666712 },
    { -3.300000000000, 1.068141502221, 0.256621712388, -1.267094400683, -1.606438457029, -0.202412942393, -0.059417821125, 0.796246710287 },
    { -3.200000000000, 1.130973355292, 0.099860358909, -1.385609268302, -1.707777943347, -0.081021914693, -0.019936095044, 0.812297953781 },
    { -3.100000000000, 1.193805208364, -0.074900887657, -1.496977831400, -1.799781563472, 0.062299209332, 0.012810202323, 0.832198710818 },
    { -3.000000000000, 1.256637061436, -0.268000666334, -1.598331045921, -1.880092358285, 0.227836565284, 0.038952082069, 0.854854681701 },
    { -2.900000000000, 1.319468914508, -0.479540713622, -1.686630367129, -1.946145357827, 0.415594820098, 0.058658916796, 0.879178270123 },
    { -2.800000000000, 1.382300767580, -0.709347101782, -1.758684892879, -1.995183072225, 0.625264943893, 0.072199023536, 0.904091677796 },
    { -2.700000000000, 1.445132620651, -0.956931235621, -1.811172891124, -2.024276087769, 0.856191466717, 0.079983779604, 0.928556303191 },
    { -2.600000000000, 1.507964473723, -1.221451114483, -1.840668070790, -2.030349054344, 1.107339677210, 0.082588726682, 0.951620530766 },
    { -2.500000000000, 1.570796326795, -1.501673424062, -1.843670923049, -2.010212318445, 1.377263288288, 0.080747332870, 0.972475017838 },
    { -2.400000000000, 1.633628179867, -1.795937081312, -1.816645418898, -1.960599415924, 1.664073162980, 0.075317640838, 0.990502939020 },
    { -2.300000000000, 1.696460032938, -2.102118914137, -1.756061298203, -1.878210589785, 1.965407760671, 0.067227565292, 1.005313720958 },
    { -2.200000000000, 1.759291886010, -2.417602214807, -1.658442124703, -1.759762440218, 2.278406029234, 0.057409133634, 1.016752829824 },
    { -2.100000000000, 1.822123739082, -2.739248960997, -1.520419210403, -1.602043746186, 2.599683530674, 0.046733793445, 1.024886047873 },
    { -2.000000000000, 1.884955592154, -3.063376549817, -1.338791431205, -1.401977419874, 2.925312645776, 0.035959463654, 1.029962454814 },
    { -1.900000000000, 1.947787445226, -3.385739936763, -1.110590863213, -1.156688466915, 3.250807755534, 0.025696051309, 1.032364219279 },
    { -1.800000000000, 2.010619298297, -3.701520111874, -0.833154066040, -0.863577726434, 3.571116342328, 0.016391299238, 1.032552456284 },
    { -1.700000000000, 2.073451151369, -4.005319877793, -0.504198725647, -0.520401055585, 3.880616990526, 0.008334670926, 1.031017107850 },
    { -1.600000000000, 2.136283004441, -4.291167917503, -0.121905245075, -0.125353503658, 4.173125292669, 0.001674464678, 1.028236086040 },
    { -1.500000000000, 2.199114857513, -4.552532151328, 0.314997262601, 0.322842108694, 4.441908682152, -0.003557387824, 1.024645935435 },
    { -1.400000000000, 2.261946710585, -4.782343381759, 0.807141268108, 0.824842928289, 4.679711214458, -0.007417786025, 1.020623849321 },
    { -1.300000000000, 2.324778563656, -4.973030208913, 1.354428247231, 1.380590996716, 4.878789304948, -0.010025848147, 1.016479356507 },
    { -1.200000000000, 2.387610416728, -5.116566167151, 1.955934229065, 1.989216391109, 5.030959400061, -0.011539461657, 1.012453346536 },
    { -1.100000000000, 2.450442269800, -5.204529982833, 2.609814635572, 2.648939764022, 5.127658508869, -0.012136027324, 1.008722084072 },
    { -1.000000000000, 2.513274122872, -5.228179782518, 3.313209745808, 3.356975633132, 5.160018451523, -0.011997567060, 1.005404203683 },
    { -0.900000000000, 2.576105975944, -5.178541988517, 4.062152289485, 4.109437939138, 5.118954588536, -0.011299849708, 1.002569151309 },
    { -0.800000000000, 2.638937829015, -5.046515522928, 4.851478846049, 4.901249558277, 4.995269678607, -0.010204944246, 1.000246005906 },
    { -0.700000000000, 2.701769682087, -4.822991800718, 5.674746894525, 5.726057621817, 4.779773371327, -0.008856547009, 0.998432003250 },
    { -0.600000000000, 2.764601535159, -4.498990825747, 6.524159523355, 6.576156655936, 4.463417673420, -0.007377470114, 0.997100372895 },
    { -0.500000000000, 2.827433388231, -4.065813509859, 7.390499965175, 7.442421708569, 4.037448532165, -0.005868765324, 0.996207295615 },
    { -0.400000000000, 2.890265241303, -3.515210113467, 8.263078265548, 8.314253771520, 3.493573456576, -0.004410055244, 0.995697911681 },
    { -0.300000000000, 2.953097094374, -2.839564456017, 9.129692523526, 9.179539933002, 2.824144845317, -0.003060732974, 0.995511381123 },
    { -0.200000000000, 3.015928947446, -2.032093266156, 9.976607251527, 10.024630803587, 2.022358410213, -0.001861764151, 0.995585034647 },
    { -0.100000000000, 3.078760800518, -1.087059734778, 10.788551488293, 10.834337843379, 1.082465775855, -0.000837881096, 0.995857672326 },
    { -0.000000000000, 3.141592653590, -0.000000000000, 11.548739357258, 11.591953275522, 0.000000000000, -0.000000000000, 0.996272076221 },
    { 0.100000000000, 3.204424506662, 1.232039067007, 12.238915788906, 12.279295296427, -1.227987602361, 0.000652277151, 0.996776808578 },
    { 0.200000000000, 3.267256359733, 2.610252790845, 12.839430115042, 12.876781281673, -2.602681334531, 0.001128189980, 0.997327371889 },
    { 0.300000000000, 3.330088212805, 4.133824757060, 13.329340190469, 13.363531633543, -4.123248104290, 0.001443469675, 0.997886811642 },
    { 0.400000000000, 3.392920065877, 5.799668860187, 13.686549598694, 13.717506816918, -5.786580358251, 0.001618185223, 0.998425846644 },
    { 0.500000000000, 3.455751918949, 7.602170620887, 13.887980348128, 13.915679979897, -7.587038243084, 0.001674840441, 0.998922614395 },
    { 0.600000000000, 3.518583772021, 9.532931508334, 13.909783259273, 13.934247349505, -9.516194723724, 0.001636757377, 0.999362119238 },
    { 0.700000000000, 3.581415625092, 11.580520458993, 13.727587977186, 13.748878326715, -11.562587844968, 0.001526763415, 0.999735468353 },
    { 0.800000000000, 3.644247478164, 13.730237236712, 13.316794212916, 13.335006874689, -13.711484777924, 0.001366182640, 1.000038974910 },
    { 0.900000000000, 3.707079331236, 15.963892724864, 12.652905419069, 12.668165395848, -15.944662739727, 0.001174117613, 1.000273199195 },
    { 1.000000000000, 3.769911184308, 18.259611671322, 11.711905634779, 11.724361823985, -18.240212306035, 0.000966996143, 1.000441987872 },
    { 1.100000000000, 3.832743037380, 20.591663812871, 10.470679691875, 10.480500114557, -20.572369042569, 0.000758349411, 1.000551559677 },
    { 1.200000000000, 3.895574890451, 22.930329677967, 8.907476354820, 8.914843697671, -22.911379755102, 0.000558782878, 1.000609673490 },
    { 1.300000000000, 3.958406743523, 25.241807695507, 7.002413271447, 7.007520763255, -25.223409986761, 0.000376099516, 1.000624902961 },
    { 1.400000000000, 4.021238596595, 27.488169511712, 4.738021839464, 4.741069476490, -27.470499666630, 0.000215535661, 1.000606031042 },
    { 1.500000000000, 4.084070449667, 29.627370626126, 2.099829246551, 2.101020375049, -29.610574022965, 0.000080072598, 1.000561568614 },
    { 1.600000000000, 4.146902302739, 31.613323588968, -0.923025977956, -0.923487719509, -31.597517006133, -0.000029208806, 1.000499393951 },
    { 1.700000000000, 4.209734155810, 33.396041043577, -4.337149550312, -4.339062931727, -33.381314508089, -0.000112757994, 1.000426504218 },
    { 1.800000000000, 4.272566008882, 34.921855836524, -8.144223860870, -8.147392410323, -34.908274604438, -0.000172191279, 1.000348866345 },
    { 1.900000000000, 4.335397861954, 36.133725241531, -12.340324053999, -12.344558068305, -36.121331868779, -0.000209951832, 1.000271352402 },
    { 2.000000000000, 4.398229715026, 36.971626038624, -16.915225724689, -16.920343953560, -36.960442504513, -0.000229004829, 1.000197743672 },
    { 2.100000000000, 4.461061568098, 37.373046744426, -21.851713388431, -21.857544409184, -37.363076593749, -0.000232575040, 1.000130787715 },
    { 2.200000000000, 4.523893421169, 37.273582690806, -27.124900095933, -27.131283397203, -37.264813164342, -0.000223930308, 1.000072293662 },
    { 2.300000000000, 4.586725274241, 36.607638885724, -32.701569787776, -32.708356582398, -36.600043012599, -0.000206211321, 1.000023252424 },
    { 2.400000000000, 4.649557127313, 35.309244651217, -38.539555199320, -38.546608987733, -35.302783280235, -0.000182305654, 0.999983970278 },
    { 2.500000000000, 4.712388980385, 33.312982909576, -44.587165313884, -44.594362220132, -33.307606660138, -0.000154762366, 0.999954206269 },
    { 2.600000000000, 4.775220833456, 30.555035671721, -50.782677501086, -50.789906403881, -30.550686788283, -0.000125742236, 0.999933305821 },
    { 2.700000000000, 4.838052686528, 26.974345765284, -57.053910543894, -57.061073025213, -26.970959862472, -0.000096998134, 0.999920324868 },
    { 2.800000000000, 4.900884539600, 22.513893119807, -63.317895726764, -63.324905860211, -22.511400808243, -0.000069879746, 0.999914140536 },
    { 2.900000000000, 4.963716392672, 17.122082000927, -69.480664000919, -69.487448001542, -17.120410386580, -0.000045357010, 0.999913545969 },
    { 3.000000000000, 5.026548245744, 10.754233455646, -75.437167931941, -75.443663688445, -10.753307508012, -0.000024056933, 0.999917328181 },
    { 3.100000000000, 5.089380098815, 3.374174900956, -81.071357638545, -81.077514147915, -3.373918687632, -0.000006309041, 0.999924328919 },
    { 3.200000000000, 5.152211951887, -5.044083734021, -86.256430217379, -86.262206940843, 5.043745946734, 0.000007804696, 0.999933489314 },
    { 3.300000000000, 5.215043804959, -14.514600604748, -90.855272183561, -90.860638341610, 14.513743383819, 0.000018398899, 0.999943879757 },
    { 3.400000000000, 5.277875658031, -25.037695446474, -94.721114206224, -94.726048029112, 25.036391353699, 0.000025735486, 0.999954716793 },
    { 3.500000000000, 5.340707511103, -36.598105138741, -97.698416848204, -97.702904797005, 36.596424017566, 0.000030178098, 0.999965369112 },
    { 3.600000000000, 5.403539364174, -49.163123639966, -99.624005094769, -99.628041066658, 49.161132022115, 0.000032151662, 0.999975354732 },
    { 3.700000000000, 5.466371217246, -62.680751810809, -100.328468144266, -100.332052674302, 62.678512436337, 0.000032107917, 0.999984331492 },
    { 3.800000000000, 5.529203070318, -77.077885915120, -99.637839201360, -99.640978671616, 77.075457358783, 0.000030497280, 0.999992082791 },
    { 3.900000000000, 5.592034923390, -92.258576867846, -97.375567830506, -97.378273696054, 92.256013264126, 0.000027747026, 0.999998500328 },
    { 4.000000000000, 5.654866776462, -108.102395543114, -93.364794765627, -93.367082805509, 108.099746401844, 0.000024245450, 1.000003565358 },
    { 4.100000000000, 5.717698629533, -124.462942609673, -87.430935906928, -87.432825506962, 124.460252713982, 0.000020331457, 1.000007329721 },
    { 4.200000000000, 5.780530482605, -141.166544366156, -79.404578547050, -79.406092020119, 141.163853744345, 0.000016288896, 1.000009897606 },
    { 4.300000000000, 5.843362335677, -158.011178840691, -69.124688640999, -69.125850589279, 158.008522803680, 0.000012344851, 1.000011408806 },
    { 4.400000000000, 5.906194188749, -174.765678928193, -56.442123157945, -56.442959880481, 174.763088164306, 0.000008671106, 1.000012023941 },
    { 4.500000000000, 5.969026041821, -191.169261489121, -41.223436225702, -41.223975173722, 191.166762208196, 0.000005387994, 1.000011911937 },
    { 4.600000000000, 6.031857894892, -206.931433045590, -23.354961905587, -23.355231187054, 206.929047164701, 0.000002569923, 1.000011239890 },
    { 4.700000000000, 6.094689747964, -221.732323900443, -2.747150030699, -2.747177964776, 221.730069263891, 0.000000251927, 1.000010165263 },
    { 4.800000000000, 6.157521601036, -235.223503084534, 20.660875371783, 20.661060650423, 235.221393711185, -0.000001563301, 1.000008830293 },
    { 4.900000000000, 6.220353454108, -247.029326416867, 46.896572939214, 46.896943826938, 247.027372768353, -0.000002898358, 1.000007358392 },
}

if TESTX then
    local origEps = test.eps
    test.eps = 1e-11

    for j = 1, #trigTest do
        local c = trigTest[j][1] + i * trigTest[j][2]

        local expected_sin  = trigTest[j][3] + i * trigTest[j][4]
        local actual_sin    = cmath.sin(c)

        local expected_cos = trigTest[j][5] + i * trigTest[j][6]
        local actual_cos   = cmath.cos(c)

        local expected_tan = trigTest[j][7] + i * trigTest[j][8]
        local actual_tan   = cmath.tan(c)

        test:checkNear(0, relError(expected_sin, actual_sin),
                      'sin ' .. j .. ' ' .. relError(expected_sin, actual_sin))

        test:checkNear(0, relError(expected_cos, actual_cos),
                      'cos ' .. j .. ' ' .. relError(expected_cos, actual_cos))

        test:checkNear(0, relError(expected_tan, actual_tan),
                      'tan ' .. j .. ' ' .. relError(expected_tan, actual_tan))
    end

    test.eps = origEps
end

inverseTrigTest = {
    { -5.000000000000, 0.000000000000, -1.570796326795, 2.292431669561, 3.141592653590, -2.292431669561, -1.373400766945, 0.000000000000 },
    { -4.900000000000, 0.062831853072, -1.557698624803, 2.271891184961, 3.128494951598, -2.271891184961, -1.369510140263, 0.002511893847 },
    { -4.800000000000, 0.125663706144, -1.544035881940, 2.251097548314, 3.114832208735, -2.251097548314, -1.365532015833, 0.005224034278 },
    { -4.700000000000, 0.188495559215, -1.529775743786, 2.230056531728, 3.100572070581, -2.230056531728, -1.361469263250, 0.008151694468 },
    { -4.600000000000, 0.251327412287, -1.514883935469, 2.208775851997, 3.085680262264, -2.208775851997, -1.357325807750, 0.011311182705 },
    { -4.500000000000, 0.314159265359, -1.499324215918, 2.187265483671, 3.070120542713, -2.187265483671, -1.353106804201, 0.014719869537 },
    { -4.400000000000, 0.376991118431, -1.483058355380, 2.165538013829, 3.053854682175, -2.165538013829, -1.348818833416, 0.018396203383 },
    { -4.300000000000, 0.439822971503, -1.466046144587, 2.143609041930, 3.036842471382, -2.143609041930, -1.344470122657, 0.022359710873 },
    { -4.200000000000, 0.502654824574, -1.448245445851, 2.121497627511, 3.019041772646, -2.121497627511, -1.340070791970, 0.026630977387 },
    { -4.100000000000, 0.565486677646, -1.429612298670, 2.099226787356, 3.000408625465, -2.099226787356, -1.335633127800, 0.031231602421 },
    { -4.000000000000, 0.628318530718, -1.410101094902, 2.076824041990, 2.980897421697, -2.076824041990, -1.331171884833, 0.036184123382 },
    { -3.900000000000, 0.691150383790, -1.389664841201, 2.054322008732, 2.960461167996, -2.054322008732, -1.326704616443, 0.041511900338 },
    { -3.800000000000, 0.753982236862, -1.368255529081, 2.031759034744, 2.939051855876, -2.031759034744, -1.322252033207, 0.047238953046 },
    { -3.700000000000, 0.816814089933, -1.345824635261, 2.009179858471, 2.916620962056, -2.009179858471, -1.317838387751, 0.053389740261 },
    { -3.600000000000, 0.879645943005, -1.322323776577, 1.986636281120, 2.893120103372, -1.986636281120, -1.313491882635, 0.059988870012 },
    { -3.500000000000, 0.942477796077, -1.297705543940, 1.964187821425, 2.868501870735, -1.964187821425, -1.309245095879, 0.067060728125 },
    { -3.400000000000, 1.005309649149, -1.271924537898, 1.941902316800, 2.842720864693, -1.941902316800, -1.305135416127, 0.074629010943 },
    { -3.300000000000, 1.068141502221, -1.244938623180, 1.919856422418, 2.815734949974, -1.919856422418, -1.301205476101, 0.082716147027 },
    { -3.200000000000, 1.130973355292, -1.216710410114, 1.898135947635, 2.787506736909, -1.898135947635, -1.297503568839, 0.091342591634 },
    { -3.100000000000, 1.193805208364, -1.187208955904, 1.876835957744, 2.758005282699, -1.876835957744, -1.294084026077, 0.100525977369 },
    { -3.000000000000, 1.256637061436, -1.156411657602, 1.856060560625, 2.727207984397, -1.856060560625, -1.291007531829, 0.110280104612 },
    { -2.900000000000, 1.319468914508, -1.124306281436, 1.835922295155, 2.695102608231, -1.835922295155, -1.288341336635, 0.120613756772 },
    { -2.800000000000, 1.382300767580, -1.090893040996, 1.816541044790, 2.661689367791, -1.816541044790, -1.286159328865, 0.131529328445 },
    { -2.700000000000, 1.445132620651, -1.056186603058, 1.798042418823, 2.626982929853, -1.798042418823, -1.284541908864, 0.143021260148 },
    { -2.600000000000, 1.507964473723, -1.020217869425, 1.780555577735, 2.591014196220, -1.780555577735, -1.283575599758, 0.155074282326 },
    { -2.500000000000, 1.570796326795, -0.983035363213, 1.764210527916, 2.553831690008, -1.764210527916, -1.283352315781, 0.167661485343 },
    { -2.400000000000, 1.633628179867, -0.944706045917, 1.749134971337, 2.515502372712, -1.749134971337, -1.283968196212, 0.180742252804 },
    { -2.300000000000, 1.696460032938, -0.905315413822, 1.735450859947, 2.476111740617, -1.735450859947, -1.285521902390, 0.194260124803 },
    { -2.200000000000, 1.759291886010, -0.864966771337, 1.723270861586, 2.435763098132, -1.723270861586, -1.288112270282, 0.208140697420 },
    { -2.100000000000, 1.822123739082, -0.823779651606, 1.712694981313, 2.394575978401, -1.712694981313, -1.291835217119, 0.222289716039 },
    { -2.000000000000, 1.884955592154, -0.781887441440, 1.703807588712, 2.352683768234, -1.703807588712, -1.296779825076, 0.236591581977 },
    { -1.900000000000, 1.947787445226, -0.739434353552, 1.696675072717, 2.310230680347, -1.696675072717, -1.303023577386, 0.250908559870 },
    { -1.800000000000, 2.010619298297, -0.696571957907, 1.691344283651, 2.267368284702, -1.691344283651, -1.310626812432, 0.265081036716 },
    { -1.700000000000, 2.073451151369, -0.653455522518, 1.687841838359, 2.224251849313, -1.687841838359, -1.319626596345, 0.278929224066 },
    { -1.600000000000, 2.136283004441, -0.610240416140, 1.686174274299, 2.181036742935, -1.686174274299, -1.330030393346, 0.292256685616 },
    { -1.500000000000, 2.199114857513, -0.567078793304, 1.686328958800, 2.137875120099, -1.686328958800, -1.341810118761, 0.304855981480 },
    { -1.400000000000, 2.261946710585, -0.524116725631, 1.688275602900, 2.094913052426, -1.688275602900, -1.354897353653, 0.316516519421 },
    { -1.300000000000, 2.324778563656, -0.481491875831, 1.691968201056, 2.052288202626, -1.691968201056, -1.369180620276, 0.327034383351 },
    { -1.200000000000, 2.387610416728, -0.439331745219, 1.697347217518, 2.010128072014, -1.697347217518, -1.384505589370, 0.336223499543 },
    { -1.100000000000, 2.450442269800, -0.397752471961, 1.704341860837, 1.968548798756, -1.704341860837, -1.400678851377, 0.343927080167 },
    { -1.000000000000, 2.513274122872, -0.356858120393, 1.712872321303, 1.927654447188, -1.712872321303, -1.417475421009, 0.350027974209 },
    { -0.900000000000, 2.576105975944, -0.316740382278, 1.722851883315, 1.887536709073, -1.722851883315, -1.434649524078, 0.354456487396 },
    { -0.800000000000, 2.638937829015, -0.277478606027, 1.734188859471, 1.848274932821, -1.734188859471, -1.451947583971, 0.357194486493 },
    { -0.700000000000, 2.701769682087, -0.239140075356, 1.746788321413, 1.809936402151, -1.746788321413, -1.469121867753, 0.358275159904 },
    { -0.600000000000, 2.764601535159, -0.201780470241, 1.760553622738, 1.772576797036, -1.760553622738, -1.485943118220, 0.357778533579 },
    { -0.500000000000, 2.827433388231, -0.165444456424, 1.775387721969, 1.736240783219, -1.775387721969, -1.502210733557, 0.355823537699 },
    { -0.400000000000, 2.890265241303, -0.130166362646, 1.791194319989, 1.700962689441, -1.791194319989, -1.517759579694, 0.352557897111 },
    { -0.300000000000, 2.953097094374, -0.095970915576, 1.807878828377, 1.666767242371, -1.807878828377, -1.532463163765, 0.348147276021 },
    { -0.200000000000, 3.015928947446, -0.062874010559, 1.825349184414, 1.633670337354, -1.825349184414, -1.546233479654, 0.342764958748 },
    { -0.100000000000, 3.078760800518, -0.030883501914, 1.843516526715, 1.601679828708, -1.843516526715, -1.559018233429, 0.336582995212 },
    { -0.000000000000, 3.141592653590, -0.000000000000, 1.862295743311, 1.570796326795, -1.862295743311, -1.570796326795, 0.329765314957 },
    { 0.100000000000, 3.204424506662, 0.029782335725, 1.881605902385, 1.541013991070, -1.881605902385, 1.560020201454, 0.322462928617 },
    { 0.200000000000, 3.267256359733, 0.058475017298, 1.901370574767, 1.512321309497, -1.901370574767, 1.550221150738, 0.314811054456 },
    { 0.300000000000, 3.330088212805, 0.086094471385, 1.921518056905, 1.484701855409, -1.921518056905, 1.541359353120, 0.306927845715 },
    { 0.400000000000, 3.392920065877, 0.112661313141, 1.941981503086, 1.458135013654, -1.941981503086, 1.533384712501, 0.298914335280 },
    { 0.500000000000, 3.455751918949, 0.138199658091, 1.962698976062, 1.432596668704, -1.962698976062, 1.526240753929, 0.290855226463 },
    { 0.600000000000, 3.518583772021, 0.162736478217, 1.983613425625, 1.408059848578, -1.983613425625, 1.519867740955, 0.282820211399 },
    { 0.700000000000, 3.581415625092, 0.186301007103, 2.004672605058, 1.384495319691, -2.004672605058, 1.514205068347, 0.274865566749 },
    { 0.800000000000, 3.644247478164, 0.208924197518, 2.025828935473, 1.361872129277, -2.025828935473, 1.509193022886, 0.267035844340 },
    { 0.900000000000, 3.707079331236, 0.230638233322, 2.047039327926, 1.340158093473, -2.047039327926, 1.504774019181, 0.259365533299 },
    { 1.000000000000, 3.769911184308, 0.251476096135, 2.068264972783, 1.319320230660, -2.068264972783, 1.500893415828, 0.251880617125 },
    { 1.100000000000, 3.832743037380, 0.271471185894, 2.089471105167, 1.299325140901, -2.089471105167, 1.497500007051, 0.244599983927 },
    { 1.200000000000, 3.895574890451, 0.290656993337, 2.110626754459, 1.280139333458, -2.110626754459, 1.494546270930, 0.237536672343 },
    { 1.300000000000, 3.958406743523, 0.309066821562, 2.131704484903, 1.261729505233, -2.131704484903, 1.491988440618, 0.230698951630 },
    { 1.400000000000, 4.021238596595, 0.326733553161, 2.152680133304, 1.244062773634, -2.152680133304, 1.489786451134, 0.224091244170 },
    { 1.500000000000, 4.084070449667, 0.343689459040, 2.173532548827, 1.227106867755, -2.173532548827, 1.487903802340, 0.217714904007 },
    { 1.600000000000, 4.146902302739, 0.359966044765, 2.194243338903, 1.210830282030, -2.194243338903, 1.486307368718, 0.211568867380 },
    { 1.700000000000, 4.209734155810, 0.375593930273, 2.214796624327, 1.195202396522, -2.214796624327, 1.484967178520, 0.205650191750 },
    { 1.800000000000, 4.272566008882, 0.390602758828, 2.235178805871, 1.180193567966, -2.235178805871, 1.483856178546, 0.199954499123 },
    { 1.900000000000, 4.335397861954, 0.405021131324, 2.255378343961, 1.165775195471, -2.255378343961, 1.482949996001, 0.194476338211 },
    { 2.000000000000, 4.398229715026, 0.418876562248, 2.275385552425, 1.151919764547, -2.275385552425, 1.482226705170, 0.189209478386 },
    { 2.100000000000, 4.461061568098, 0.432195453967, 2.295192406792, 1.138600872828, -2.295192406792, 1.481666604019, 0.184147146757 },
    { 2.200000000000, 4.523893421169, 0.445003086288, 2.314792367247, 1.125793240507, -2.314792367247, 1.481252003769, 0.179282218096 },
    { 2.300000000000, 4.586725274241, 0.457323618583, 2.334180216017, 1.113472708212, -2.334180216017, 1.480967033150, 0.174607365898 },
    { 2.400000000000, 4.649557127313, 0.469180102109, 2.353351908742, 1.101616224686, -2.353351908742, 1.480797457999, 0.170115181549 },
    { 2.500000000000, 4.712388980385, 0.480594500437, 2.372304439232, 1.090201826358, -2.372304439232, 1.480730516198, 0.165798267409 },
    { 2.600000000000, 4.775220833456, 0.491587716218, 2.391035716860, 1.079208610577, -2.391035716860, 1.480754767500, 0.161649308684 },
    { 2.700000000000, 4.838052686528, 0.502179622756, 2.409544455809, 1.068616704038, -2.409544455809, 1.480859957503, 0.157661128081 },
    { 2.800000000000, 4.900884539600, 0.512389099106, 2.427830075324, 1.058407227689, -2.427830075324, 1.481036894863, 0.153826726558 },
    { 2.900000000000, 4.963716392672, 0.522234067623, 2.445892610142, 1.048562259172, -2.445892610142, 1.481277340759, 0.150139312889 },
    { 3.000000000000, 5.026548245744, 0.531731533077, 2.463732630252, 1.039064793718, -2.463732630252, 1.481573909598, 0.146592324272 },
    { 3.100000000000, 5.089380098815, 0.540897622600, 2.481351169190, 1.029898704194, -2.481351169190, 1.481919979961, 0.143179439801 },
    { 3.200000000000, 5.152211951887, 0.549747625874, 2.498749660096, 1.021048700921, -2.498749660096, 1.482309614831, 0.139894588284 },
    { 3.300000000000, 5.215043804959, 0.558296035093, 2.515929878804, 1.012500291702, -2.515929878804, 1.482737490205, 0.136731951623 },
    { 3.400000000000, 5.277875658031, 0.566556584324, 2.532893893299, 1.004239742471, -2.532893893299, 1.483198831244, 0.133685964736 },
    { 3.500000000000, 5.340707511103, 0.574542287980, 2.549644018889, 0.996254038814, -2.549644018889, 1.483689355196, 0.130751312803 },
    { 3.600000000000, 5.403539364174, 0.582265478189, 2.566182778548, 0.988530848606, -2.566182778548, 1.484205220376, 0.127922926504 },
    { 3.700000000000, 5.466371217246, 0.589737840891, 2.582512867854, 0.981058485904, -2.582512867854, 1.484742980576, 0.125195975736 },
    { 3.800000000000, 5.529203070318, 0.596970450571, 2.598637124086, 0.973825876224, -2.598637124086, 1.485299544317, 0.122565862251 },
    { 3.900000000000, 5.592034923390, 0.603973803535, 2.614558498997, 0.966822523260, -2.614558498997, 1.485872138426, 0.120028211527 },
    { 4.000000000000, 5.654866776462, 0.610757849702, 2.630280034900, 0.960038477093, -2.630280034900, 1.486458275474, 0.117578864143 },
    { 4.100000000000, 5.717698629533, 0.617332022894, 2.645804843679, 0.953464303901, -2.645804843679, 1.487055724653, 0.115213866878 },
    { 4.200000000000, 5.780530482605, 0.623705269629, 2.661136088427, 0.947091057166, -2.661136088427, 1.487662485718, 0.112929463670 },
    { 4.300000000000, 5.843362335677, 0.629886076432, 2.676276967398, 0.940910250363, -2.676276967398, 1.488276765674, 0.110722086594 },
    { 4.400000000000, 5.906194188749, 0.635882495710, 2.691230700034, 0.934913831085, -2.691230700034, 1.488896957890, 0.108588346938 },
    { 4.500000000000, 5.969026041821, 0.641702170222, 2.706000514812, 0.929094156573, -2.706000514812, 1.489521623394, 0.106525026453 },
    { 4.600000000000, 6.031857894892, 0.647352356192, 2.720589638726, 0.923443970603, -2.720589638726, 1.490149474108, 0.104529068841 },
    { 4.700000000000, 6.094689747964, 0.652839945130, 2.735001288193, 0.917956381665, -2.735001288193, 1.490779357809, 0.102597571511 },
    { 4.800000000000, 6.157521601036, 0.658171484396, 2.749238661241, 0.912624842399, -2.749238661241, 1.491410244638, 0.100727777637 },
    { 4.900000000000, 6.220353454108, 0.663353196590, 2.763304930814, 0.907443130205, -2.763304930814, 1.492041214990, 0.098917068538 },
}

if TESTX then
    for j = 1, #inverseTrigTest do
        local c = inverseTrigTest[j][1] + i * inverseTrigTest[j][2]

        local expected_asin  = inverseTrigTest[j][3] + i * inverseTrigTest[j][4]
        local actual_asin    = cmath.asin(c)

        test:checkNear(0, relError(expected_asin, actual_asin),
                      'asin ' .. j .. ' ' .. relError(expected_asin, actual_asin))

        local expected_acos = inverseTrigTest[j][5] + i * inverseTrigTest[j][6]
        local actual_acos   = cmath.acos(c)

        test:checkNear(0, relError(expected_acos, actual_acos),
                      'acos ' .. j .. ' ' .. relError(expected_acos, actual_acos))

        local expected_atan = inverseTrigTest[j][7] + i * inverseTrigTest[j][8]
        local actual_atan   = cmath.atan2(c)

        test:checkNear(0, relError(expected_atan, actual_atan),
                      'atan ' .. j .. ' ' .. relError(expected_atan, actual_atan))
    end
end

if TESTX then
    local t = {}
    t[i+1] = 4
    test:check(4, t[i+1], "table index")
end
